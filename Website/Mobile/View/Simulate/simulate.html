<!doctype html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta content="telephone=no" name="format-detection">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <title>全真模拟</title>
    <link href="__STATIC__/theory_study/css/media-queries.css" rel="stylesheet" type="text/css">
    <link href="__STATIC__/theory_study/css/initialize.css" rel="stylesheet" type="text/css">
    <link href="__STATIC__/theory_study/css/theory_study.css" rel="stylesheet" type="text/css">
    <script src="__PUBLIC__/public/js/jquery-3.2.1.min.js"></script>
    <link rel="stylesheet" href="__STATIC__/theory_study/css/style.css">
    <script src="__PUBLIC__/public/mui/js/mui.min.js"></script>
    <script src="__PUBLIC__/public/js/layer_mobile/layer.js"></script>
    <!--标准mui.css-->
    <link rel="stylesheet" href="__PUBLIC__/public/mui/css/mui.min.css">
    <!--App自定义的css-->
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/public/mui/css/app.css" />
    <style>
        .options li{
            cursor: pointer;border-bottom: 1px solid #eee;
        }
    </style>
    <script>
        //获取浏览器页面可见高度和宽度
        var _PageHeight = document.documentElement.clientHeight,
                _PageWidth = document.documentElement.clientWidth;
        //计算loading框距离顶部和左部的距离（loading框的宽度�?15px，高度为61px�?
        var _LoadingTop = _PageHeight > 61 ? (_PageHeight - 61) / 2 : 0,
                _LoadingLeft = _PageWidth > 215 ? (_PageWidth - 215) / 2 : 0;
        //在页面未加载完毕之前显示的loading Html自定义内�?
        var _LoadingHtml = '<div id="loadingDiv" style="position:absolute;left:0;width:100%;height:'
                + _PageHeight + 'px;top:0;background:#f3f8ff;opacity:0.8;filter:alpha(opacity=80);z-index:10000;">' +
                '<div style="position: absolute; cursor1: wait; left: ' + _LoadingLeft + 'px; top:'
                + _LoadingTop + 'px; width: auto; height: 57px; line-height: 57px; padding-left: 50px; padding-right: 30px;font-size:14px; background: #fff url(/Uploads/smallpic/jz.gif) no-repeat scroll 5px 10px; border: 1px solid #757575;border-radius:5px; color: #696969; font-family:\'Microsoft YaHei\';">页面加载中，请稍等...</div></div>';
        //呈现loading效果
        document.write(_LoadingHtml);
        window.onload = function () {
            var loadingMask = document.getElementById('loadingDiv');
            loadingMask.parentNode.removeChild(loadingMask);
        };
    </script>
</head>

<body>
    <div class="header_box">
        <div class="header">
            <ul>
                <a href="javascript:;">
                    <li class="back submit" ms="{$ms}" mt="{$mt}">
                        <img src="__PUBLIC__/public/images/back.png">
                    </li>
                </a>
                <li class="header_text">{$ms==1?'科一':'科四'}全真模拟</li>
                <div class="clearfix"></div>
            </ul>
        </div>
    </div>

    <div class="main_box" id="loadingDiv">
        <div class="mui-slider theory_study">
            <div class="mui-slider-group ">
                <!-- 额外增加的一个节�?循环轮播：第一个节点是最后一个图文表�? -->
                <volist name="chapter" id="chap" empty="$empty" key="k">
                    <div class="mui-slider-item" style="background-color: white">
                        <div class="title_{$chap.id}"  answer="{$chap.answer}">
                            <p style="font-size: 14px;width: 90%;margin-left: 2%">{$k}.{$chap.question}
                                <if condition="$chap.ifmul eq 0">单选</if>
                                <if condition="$chap.ifmul eq 1">多选</if>
                                <if condition="$chap.ifmul eq 2">判断</if>
                                </p>
                        </div>
                        <div class="img" style="width: 50%">
                            <if condition="$chap.image neq '0'">
                                <img src="{$http}/Uploads{$chap.image}">
                            </if>
                        </div>
                        <div class="options">
                            <if condition="$chap.ifmul eq 1">
                                <form action="" id="form_{$chap.id}">
                                    <input type="hidden" name="answer" value="{$chap.answer}"/>
                                    <ul>
                                        <li class="select_A" gid="{$chap.id}" >
                                            <label>
                                                <input type="checkbox" class="mA_{$chap.id}" style="display: none" value="mA_{$chap.id}" name="ms[]"/>
                                                <img id="mA_{$chap.id}" style="width: 20px;height:20px;display: inline-block;position: absolute;"    src="__STATIC__/chapter_practice/images/abcd_01.png" alt=""/>
                                            </label>
                                            <span style="margin-left: 7%;font-size: 16px">{$chap.s1}</span>
                                        </li>
                                        <li style="margin-top: 2%;"   class="select_B" gid="{$chap.id}" >
                                            <label>
                                                <input type="checkbox" class="mB_{$chap.id}" style="display: none"  value="mB_{$chap.id}" name="ms[]"/>
                                                <img id="mB_{$chap.id}" style="width: 20px;height:20px;display: inline-block;position: absolute;"   src="__STATIC__/chapter_practice/images/abcd_02.png" alt=""/>
                                            </label>
                                            <span style="margin-left: 7%;font-size: 15px">{$chap.s2}</span>
                                        </li>
                                        <li style="margin-top: 2%;"  class="select_C" gid="{$chap.id}">
                                            <label>
                                                <input type="checkbox" class="mC_{$chap.id}" style="display: none"  value="mC_{$chap.id}" name="ms[]"/>
                                                <img  id="mC_{$chap.id}"   style="width: 20px;height:20px;display: inline-block;position: absolute;"  src="__STATIC__/chapter_practice/images/abcd_03.png" alt=""/>
                                            </label>
                                            <span style="margin-left: 7%;font-size: 15px">{$chap.s3}</span>
                                        </li>
                                        <li style="margin-top: 2%;"  class="select_D"  gid="{$chap.id}" >
                                            <label>
                                                <input type="checkbox" class="mD_{$chap.id}" style="display: none"  value="mD_{$chap.id}" name="ms[]"/>
                                                <img id="mD_{$chap.id}" style="width: 20px;height:20px;display: inline-block;position: absolute;"  src="__STATIC__/chapter_practice/images/abcd_04.png" alt=""/>
                                                <span style="margin-left: 7%;font-size: 15px">{$chap.s4}</span>
                                            </label>
                                        </li>
                                        <div id="button_{$chap.id}" style="float: right;margin-top: 2%">
                                            <input type="button" class="button" gid="{$chap.id}" value="提交" style=""/>
                                        </div>
                                    </ul>
                                </form>
                                <else/>
                                <ul>
                                    <li class="select_A" gid="{$chap.id}" style="cursor: pointer;border-bottom: 1px solid #eee" >
                                        <label>
                                            <img id="sA_{$chap.id}" style="width: 20px;height:20px;display: inline-block;vertical-align: middle;"    src="__STATIC__/chapter_practice/images/abcd_01.png" alt=""/>
                                            {$chap.s1}
                                        </label>
                                    </li>
                                    <li class="select_B" gid="{$chap.id}" style="cursor: pointer">
                                        <label>
                                            <img id="sB_{$chap.id}" style="width: 20px;height:20px;display: inline-block;vertical-align: middle;"   src="__STATIC__/chapter_practice/images/abcd_02.png" alt=""/>
                                            {$chap.s2}
                                        </label>
                                    </li>
                                    <if condition="$chap.ifmul eq 0" >
                                        <li class="select_C" gid="{$chap.id}" style="cursor: pointer">
                                            <label>
                                                <img  id="sC_{$chap.id}"   style="width: 20px;height:20px;display: inline-block;vertical-align: middle;"  src="__STATIC__/chapter_practice/images/abcd_03.png" alt=""/>
                                                {$chap.s3}
                                            </label>
                                        </li>
                                        <li class="select_D"  gid="{$chap.id}" >
                                            <label>
                                                <img id="sD_{$chap.id}" style="width: 20px;height:20px;display: inline-block;vertical-align: middle;"  src="__STATIC__/chapter_practice/images/abcd_04.png" alt=""/>
                                                {$chap.s4}
                                            </label>
                                        </li>
                                    </if>
                                </ul>
                            </if>
                        </div>
                    </div>
                </volist>
            </div>
            <footer id="foot_theoryStudy">
                <ul class="mui-slider-indicator" >
                    <li class="foot_option">
                        <button style="line-height: 0">
                            <img src="__STATIC__/theory_study/images/Countdown.png">
                            <p id="endtime" style="line-height: 2px">{$ms==1?2700:1800}</p>
                        </button>
                    </li>
                    {$subject}  {$type}
                    <li class="foot_option submit" ms="{$ms}" mt="{$mt}" >
                        <button class="cd-popup-trigger" style="line-height: 0">
                            <img src="__STATIC__/theory_study/images/submit.png">
                            <p style="margin-top: 8px;">交卷</p>
                        </button>
                    </li>
                    <li class="foot_option">
                        <button style="line-height: 0">
                            <img src="__STATIC__/theory_study/images/plan.png">
                            <div class="mui-number" style="line-height: 0px;margin-bottom: 0px;padding: 0">
                                <span class="k" style="">1</span> / {$ms==1?100:50}
                            </div>
                        </button>
                    </li>
                </ul>
            </footer>
        </div>
    </div>
    <script src="__PUBLIC__/public/mui/js/mui.min.js"></script>
    <script>
    $(".select_A").click(function(){
        var id=$(this).attr('gid');
        var title='.title_'+id;
        var answer=$(title).attr('answer');
        idName='s'+answer+'_'+$(this).attr('gid');
        if(answer.length==1){
            $('#sA_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_05.png');
            $('#sB_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_02.png');
            $('#sC_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_03.png');
            $('#sD_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_04.png');
            $.post('{:U("Mobile/Simulate/one_judge")}',{id:id,user_answer:'A'},function(res){
            },'json');
        }else{
            var checkbox = $('.mA_'+id);
            if(checkbox.data('waschecked')==true){
                checkbox.prop('checked',false);
                checkbox.data('waschecked',false);
                $('#mA_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_01.png')
            } else{
                checkbox.prop('checked',true);
                checkbox.data('waschecked',true);
                $('#mA_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_05.png')
            }
        }
    });

    $(".select_B").click(function(){
        var id=$(this).attr('gid');
        var title='.title_'+id;
        var answer=$(title).attr('answer');
        idName='s'+answer+'_'+$(this).attr('gid');
        if(answer.length==1){
            $('#sA_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_01.png');
            $('#sB_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_05.png');
            $('#sC_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_03.png');
            $('#sD_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_04.png');
        }else{
            var checkbox = $('.mB_'+id);
            if(checkbox.data('waschecked')==true){
                checkbox.prop('checked',false);
                checkbox.data('waschecked',false);
                $('#mB_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_02.png')
            }else{
                checkbox.prop('checked',true);
                checkbox.data('waschecked',true);
                $('#mB_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_05.png')
            }
        }

        $.post('{:U("Mobile/Simulate/one_judge")}',{id:id,user_answer:'B'},function(res){
        },'json');

    });

    $(".select_C").click(function(){
        var id=$(this).attr('gid');
        var title='.title_'+id;
        var answer=$(title).attr('answer');
        idName='s'+answer+'_'+$(this).attr('gid');
        if(answer.length == 1){
            $('#sA_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_01.png');
            $('#sB_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_02.png');
            $('#sC_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_05.png');
            $('#sD_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_04.png');
        }else{
            var checkbox = $('.mC_'+id);
            if(checkbox.data('waschecked')==true){
                checkbox.prop('checked',false);
                checkbox.data('waschecked',false);
                $('#mC_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_03.png')
            }else{
                checkbox.prop('checked',true);
                checkbox.data('waschecked',true);
                $('#mC_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_05.png')
            }
        }

        $.post('{:U("Mobile/Simulate/one_judge")}',{id:id,user_answer:'C'},function(res){
        },'json');


    });

    $(".select_D").click(function(){
        var id=$(this).attr('gid');
        var title='.title_'+id;
        var answer=$(title).attr('answer');
        idName='s'+answer+'_'+$(this).attr('gid');
        if(answer.length == 1){
            $('#sA_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_01.png');
            $('#sB_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_02.png');
            $('#sC_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_03.png');
            $('#sD_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_05.png');
        }else{
            var checkbox = $('.mD_'+id);
            if(checkbox.data('waschecked')==true){
                checkbox.prop('checked',false);
                checkbox.data('waschecked',false);
                $('#mD_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_04.png')
            }else{
                checkbox.prop('checked',true);
                checkbox.data('waschecked',true);
                $('#mD_'+id).attr('src','__STATIC__/chapter_practice/images/abcd_05.png')
            }
        }

        $.post('{:U("Mobile/Simulate/one_judge")}',{id:id,user_answer:'D'},function(res){
        },'json');

    });

    $('.button').click(function(){
        var id = $(this).attr('gid');
        $.post('{:U("Mobile/Simulate/judge")}',$("#form_"+id).serialize(),function(res) {
            if(res.info=='请选择答案'){
                layer.open({
                    content: res.info
                    ,skin: 'msg'
                    ,icon:2
                    ,style: "background-color:#DAEAD3; font-color:white; border:none;" //自定风格
                    ,time: 2 //2秒后自动关闭
                });
            }
        },'json')
    });





//--------------------------------倒计时事�?---------------------------
    var CID = "endtime";
    if(window.CID != null)
    {
        var iTime = document.getElementById(CID).innerText;
        var Account;
        RemainTime();
    }
    function RemainTime()
    {
        var iDay,iHour,iMinute,iSecond;
        var sDay="",sHour="",sMinute="",sSecond="",sTime="";
        if (iTime >= 0)
        {
            iDay = parseInt(iTime/24/3600);
            if (iDay > 0)
            {
                sDay = iDay + "天";
            }
            iHour = parseInt((iTime/3600)%24);
            if (iHour > 0){
                sHour = iHour + ":";
            }
            iMinute = parseInt((iTime/60)%60);
            if (iMinute > 0){
                sMinute = iMinute + ":";
            }
            iSecond = parseInt(iTime%60);
            if (iSecond >= 0){
                sSecond = iSecond;
            }
            if ((sDay=="")&&(sHour=="")){
                sTime="<span style='color:#646464;'>" + sMinute+sSecond + "</font>";
            }
            else
            {
                sTime=sDay+sHour+sMinute+sSecond;
            }
            if(iTime==0) {
                var mt = $(this).attr('mt');
                var ms = $(this).attr('ms');
                layer.open({
                    content: '时间到了，你确定要交卷吗?'
                    , btn: ['交卷', '不要']
                    , yes: function (index) {
                        location.href = "{:U('Mobile/Simulate/result')}?time=" + iTime + "&ms=" + ms + "&mt=" + mt;
                        layer.close(index);
                    }
                });
            } else {
                Account = setTimeout("RemainTime()",1000);
            }
            iTime=iTime-1;
        }
        else
        {
            sTime="<span style='color:#d9221e'>倒计时结束！</span>";
        }
        document.getElementById(CID).innerHTML = sTime;
    }

    $(".submit").click(function(){
        var mt = $(this).attr('mt');
        var ms = $(this).attr('ms');
        layer.open({
            content: '你确定要交卷吗？'
            ,btn: ['交卷', '不要']
            ,yes: function(index){
                location.href = "{:U('Mobile/Simulate/result')}?time="+iTime+"&ms="+ms+"&mt="+mt;
                layer.close(index);
            }
        });
    });
    mui.init();
</script>

</body>
</html>