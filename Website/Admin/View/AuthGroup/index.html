<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <title>管理组列表</title>
    <link href="__STATIC__/ment/css/mine.css" type="text/css" rel="stylesheet" />
    <script src="__PUBLIC__/public/js/jquery-3.2.1.min.js"></script>
    <script src="__PUBLIC__/public/js/layer/layer.js"></script>
    <style>
        .table_a td,th{border:1px solid rgba(39, 164, 237, 0.22);font-size: 13px;}
        .table_a  td{  border: dotted 1px rgba(39, 164, 237, 0.22);text-align: center}
    </style>
</head>
<body>
    <div class="div_head" style="background-color: rgb(129, 191, 249);font-weight: bolder;color: #ffffff">
        管理组列表
        <if condition="get['add_group'] eq '0'">
            <a style="text-decoration: none;color:#ff143f;font-size: 15px" href="javascript:alert('暂无权限')" >【管理组添加】</a>
            <else/>
            <a style="text-decoration: none;color:#fa7124;font-size: 15px" href="{:U($get['add_group'],array('pid'=>$get['pid']))}">【管理组添加】</a>
        </if>
    </div>
    <div style="font-size: 13px; margin: 10px 5px;">
        <table class="table_a" style="border:1px solid rgb(129, 191, 249)" width="100%">
            <tbody>
                <tr style="font-weight: bold;height: 35px;background-color:  rgb(129, 191, 249);color: #ffffff">
                    <th>编号</th>
                    <th>管理组名称</th>
                    <th>成员</th>
                    <th>操作</th>
                </tr>
                <volist name="groupList" id="value" key="k">
                    <tr>
                        <td>{$k}</td>
                        <td>{$value.title}</td>
                        <td>{$value.member}</td>
                        <td>
                            <a href="{:U('add_member',array('gid'=>$value['id'],'pid'=>$get['pid']))}" class="tablelink">添加组员</a> ｜
                            <a href="{:U('allocateRule',array('gid'=>$value['id'],'member'=>$value['member'],'pid'=>$get['pid']))}" class="tablelink">分配权限</a> ｜
                            <a href="{:U('add_group',array('id'=>$value['id'],'pid'=>$get['pid']))}" class="tablelink">编辑</a> ｜
                            <a href="#" id="{$value.id}" pid="{$get['pid']}" class="tablelink del">删除</a>
                        </td>
                    </tr>
                </volist>
            </tbody>
        </table>
    </div>
</body>
</html>
<script>
    $('.del').click(function(){
        var id = $(this).attr('id');
        var pid = $(this).attr('pid');
        $.post("{:U('AuthGroup/del')}",{id:id,pid:pid},function(res){
            if(res.status==1){
                layer.msg(res.info,{icon:6,time:2000},function(){
                    location=res.url;
                })
            }else{
                layer.msg(res.info,{icon:5,time:2000},function(){
                    location=res.url;
                })
            }
        })
    });
</script>